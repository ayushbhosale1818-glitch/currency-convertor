<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Secure Currency Converter</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Basic styling -->
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background: #0f172a;
      padding: 1rem;
    }

    .app {
      width: 100%;
      max-width: 480px;
      background: #020617;
      color: #e5e7eb;
      border-radius: 1.5rem;
      padding: 1.5rem;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.6);
      border: 1px solid #1f2937;
    }

    .app-header {
      margin-bottom: 1.5rem;
    }

    .app-title {
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: 0.25rem;
    }

    .app-subtitle {
      font-size: 0.875rem;
      color: #9ca3af;
    }

    label {
      font-size: 0.85rem;
      color: #9ca3af;
      display: block;
      margin-bottom: 0.35rem;
      margin-top: 0.75rem;
    }

    input, select {
      width: 100%;
      padding: 0.6rem 0.75rem;
      border-radius: 0.75rem;
      border: 1px solid #374151;
      background: #020617;
      color: #e5e7eb;
      font-size: 0.95rem;
      outline: none;
    }

    input:focus, select:focus {
      border-color: #4f46e5;
      box-shadow: 0 0 0 1px #4f46e5;
    }

    .row {
      display: flex;
      gap: 0.75rem;
      align-items: flex-end;
      margin-top: 0.75rem;
    }

    .row > div {
      flex: 1;
    }

    .swap-btn {
      padding: 0.55rem 0.9rem;
      border-radius: 999px;
      border: 1px solid #4b5563;
      background: #111827;
      color: #e5e7eb;
      font-size: 0.85rem;
      cursor: pointer;
      white-space: nowrap;
    }

    .swap-btn:hover {
      background: #1f2937;
    }

    .popular-wrap {
      margin-top: 0.75rem;
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
    }

    .pill-btn {
      padding: 0.35rem 0.8rem;
      border-radius: 999px;
      border: 1px solid #4b5563;
      background: #020617;
      color: #9ca3af;
      font-size: 0.8rem;
      cursor: pointer;
    }

    .pill-btn:hover {
      background: #1f2937;
      color: #e5e7eb;
    }

    .convert-btn {
      margin-top: 1.3rem;
      width: 100%;
      padding: 0.8rem;
      border-radius: 0.9rem;
      border: none;
      background: linear-gradient(135deg, #4f46e5, #06b6d4);
      color: white;
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer;
    }

    .convert-btn:active {
      transform: scale(0.99);
    }

    .result-card {
      margin-top: 1.3rem;
      padding: 1rem;
      border-radius: 1rem;
      background: #020617;
      border: 1px solid #1f2937;
    }

    .result-main {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 0.4rem;
    }

    .result-sub {
      font-size: 0.85rem;
      color: #9ca3af;
      margin-bottom: 0.25rem;
    }

    .muted {
      font-size: 0.78rem;
      color: #6b7280;
    }

    .error {
      margin-top: 0.6rem;
      font-size: 0.85rem;
      color: #fecaca;
      background: #7f1d1d;
      padding: 0.4rem 0.6rem;
      border-radius: 0.75rem;
    }

    @media (max-width: 480px) {
      .app {
        padding: 1.25rem;
        border-radius: 1.25rem;
      }
    }
  </style>
</head>
<body>
  <main class="app" aria-labelledby="appTitle">
    <header class="app-header">
      <h1 id="appTitle" class="app-title">Currency Converter</h1>
      <p class="app-subtitle">Secure, fast, and easy conversions with live exchange rates.</p>
    </header>

    <!-- Amount -->
    <div>
      <label for="amount">Amount</label>
      <input
        type="number"
        id="amount"
        placeholder="Enter amount"
        min="0"
        step="0.01"
        inputmode="decimal"
      />
    </div>

    <!-- From / To row -->
    <div class="row" aria-label="Currency selection">
      <div>
        <label for="fromCurrency">From</label>
        <select id="fromCurrency"></select>
      </div>

      <button type="button" class="swap-btn" id="swapBtn" aria-label="Swap currencies">
        ⇄ Swap
      </button>

      <div>
        <label for="toCurrency">To</label>
        <select id="toCurrency"></select>
      </div>
    </div>

    <!-- Popular quick buttons -->
    <div>
      <label>Popular pairs</label>
      <div class="popular-wrap">
        <button type="button" class="pill-btn" data-from="USD" data-to="INR">USD → INR</button>
        <button type="button" class="pill-btn" data-from="INR" data-to="USD">INR → USD</button>
        <button type="button" class="pill-btn" data-from="EUR" data-to="INR">EUR → INR</button>
        <button type="button" class="pill-btn" data-from="USD" data-to="EUR">USD → EUR</button>
        <button type="button" class="pill-btn" data-from="GBP" data-to="INR">GBP → INR</button>
      </div>
    </div>

    <!-- Convert button -->
    <button type="button" class="convert-btn" id="convertBtn">
      Convert
    </button>

    <!-- Result -->
    <section class="result-card" aria-live="polite">
      <div id="resultMain" class="result-main">Result will appear here</div>
      <div id="resultRate" class="result-sub"></div>
      <div id="lastUpdated" class="muted"></div>
      <div id="errorBox" class="error" style="display: none;"></div>
    </section>
  </main>

  <script>
    // ========= CONFIG =========
    // Using a free, no-auth API (Frankfurter).
    // In production, call an API from your backend to hide keys and add rate limiting.
    const API_BASE = "https://api.frankfurter.app";

    const currencies = [
      "USD", "EUR", "INR", "GBP", "AUD", "CAD", "CHF",
      "JPY", "CNY", "SGD", "NZD", "AED", "SAR", "ZAR"
    ];

    const amountInput   = document.getElementById("amount");
    const fromSelect    = document.getElementById("fromCurrency");
    const toSelect      = document.getElementById("toCurrency");
    const swapBtn       = document.getElementById("swapBtn");
    const convertBtn    = document.getElementById("convertBtn");
    const resultMain    = document.getElementById("resultMain");
    const resultRate    = document.getElementById("resultRate");
    const lastUpdatedEl = document.getElementById("lastUpdated");
    const errorBox      = document.getElementById("errorBox");

    // ========= INIT =========
    function populateCurrencySelect(selectEl) {
      currencies.forEach(code => {
        const opt = document.createElement("option");
        opt.value = code;
        opt.textContent = code;
        selectEl.appendChild(opt);
      });
    }

    function loadLastSelection() {
      try {
        const saved = JSON.parse(localStorage.getItem("currencySelection"));
        if (saved && saved.from && saved.to) {
          if (currencies.includes(saved.from)) fromSelect.value = saved.from;
          if (currencies.includes(saved.to)) toSelect.value = saved.to;
        } else {
          fromSelect.value = "USD";
          toSelect.value = "INR";
        }
      } catch (e) {
        fromSelect.value = "USD";
        toSelect.value = "INR";
      }
    }

    function saveSelection() {
      const data = {
        from: fromSelect.value,
        to: toSelect.value
      };
      localStorage.setItem("currencySelection", JSON.stringify(data));
    }

    function showError(message) {
      errorBox.style.display = "block";
      errorBox.textContent = message;
    }

    function clearError() {
      errorBox.style.display = "none";
      errorBox.textContent = "";
    }

    async function convertCurrency() {
      clearError();

      const amount = parseFloat(amountInput.value);
      const from = fromSelect.value;
      const to = toSelect.value;

      if (isNaN(amount) || amount <= 0) {
        showError("Please enter a valid amount greater than 0.");
        return;
      }

      if (from === to) {
        resultMain.textContent = ${amount.toFixed(2)} ${from} = ${amount.toFixed(2)} ${to};
        resultRate.textContent = "Same currency selected.";
        lastUpdatedEl.textContent = "";
        return;
      }

      try {
        convertBtn.disabled = true;
        convertBtn.textContent = "Converting...";

        const url = ${API_BASE}/latest?amount=${encodeURIComponent(amount)}&from=${encodeURIComponent(from)}&to=${encodeURIComponent(to)};
        const res = await fetch(url, { method: "GET" });

        if (!res.ok) {
          throw new Error("Failed to fetch rates. Try again later.");
        }

        const data = await res.json();
        const rate = data.rates[to];
        const converted = rate;

        resultMain.textContent = ${amount.toFixed(2)} ${from} = ${converted.toFixed(2)} ${to};
        resultRate.textContent = Rate: 1 ${from} = ${(rate / amount).toFixed(4)} ${to};
        lastUpdatedEl.textContent = Last updated: ${data.date};
        saveSelection();
      } catch (err) {
        showError(err.message || "Something went wrong. Please try again.");
        console.error(err);
      } finally {
        convertBtn.disabled = false;
        convertBtn.textContent = "Convert";
      }
    }

    function swapCurrencies() {
      const temp = fromSelect.value;
      fromSelect.value = toSelect.value;
      toSelect.value = temp;
      saveSelection();
    }

    function handlePopularClick(e) {
      const btn = e.target.closest("[data-from]");
      if (!btn) return;
      fromSelect.value = btn.dataset.from;
      toSelect.value = btn.dataset.to;
      saveSelection();
      convertCurrency();
    }

    // Attach events
    document.addEventListener("DOMContentLoaded", () => {
      populateCurrencySelect(fromSelect);
      populateCurrencySelect(toSelect);
      loadLastSelection();

      swapBtn.addEventListener("click", swapCurrencies);
      convertBtn.addEventListener("click", convertCurrency);

      document
        .querySelector(".popular-wrap")
        .addEventListener("click", handlePopularClick);

      // Optional: Enter key to submit
      amountInput.addEventListener("keydown", (e) => {
        if (e.key === "Enter") {
          convertCurrency();
        }
      });
    });
  </script>
</body>
</html>